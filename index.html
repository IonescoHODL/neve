<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Anniversaire N√®ve 7 ans</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Varela+Round&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-grass: #8fd8a0;
            --passport-bg: #fffdf0;
            --ac-green: #5bbd83;
            --ac-blue: #2aa5ef;
            --ac-text: #795548;
            --ac-orange: #f27328;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            margin: 0; padding: 0;
            background-color: var(--bg-grass);
            background-image: 
                linear-gradient(115deg, transparent 75%, rgba(60, 138, 87, 0.15) 75%),
                linear-gradient(245deg, transparent 75%, rgba(60, 138, 87, 0.15) 75%),
                linear-gradient(115deg, transparent 75%, rgba(60, 138, 87, 0.15) 75%),
                linear-gradient(245deg, transparent 75%, rgba(60, 138, 87, 0.15) 75%);
            background-size: 60px 120px;
            background-position: 0 0, 0 0, 30px 60px, 30px 60px;
            font-family: 'Varela Round', sans-serif;
            
            /* CORRECTION SCROLL MOBILE */
            min-height: 100vh; /* Au moins la hauteur de l'√©cran, mais peut grandir */
            height: auto;
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: flex-start; /* Commence en haut */
            overflow-x: hidden; /* Cache juste le d√©bordement horizontal */
            overflow-y: auto; /* Autorise le scroll vertical */
            padding: 40px 0 120px 0; /* Marge Haut et Bas (large en bas pour passer au dessus de Marie) */
        }

        /* --- LOGO DU JEU --- */
        .game-logo {
            width: 180px;
            margin-bottom: 20px;
            filter: drop-shadow(0 4px 0 rgba(0,0,0,0.1));
            z-index: 10;
            /* Animation flottante */
            animation: floatLogo 3s ease-in-out infinite;
        }
        @keyframes floatLogo { 0%,100%{transform:translateY(0);} 50%{transform:translateY(-5px);} }

        /* --- BALLON CADEAU --- */
        .balloon-container {
            position: absolute; top: 20px; right: 10px; width: 70px; height: 100px;
            z-index: 5; animation: floatBalloon 5s ease-in-out infinite;
        }
        @keyframes floatBalloon { 0%, 100% { transform: translateY(0) rotate(5deg); } 50% { transform: translateY(-15px) rotate(-5deg); } }
        
        .gift-box {
            width: 30px; height: 30px; background: white; border: 2px solid #555;
            position: absolute; bottom: 0; left: 20px; border-radius: 4px;
            box-shadow: 2px 4px 0 rgba(0,0,0,0.1);
        }
        .gift-ribbon { position: absolute; width: 100%; height: 5px; background: #ff5252; top: 12px; }
        .gift-ribbon-v { position: absolute; width: 5px; height: 100%; background: #ff5252; left: 12px; }

        /* --- MARIE (ISABELLE) --- */
        /* Elle est maintenant FIXED pour rester en bas de l'√©cran sans g√™ner le scroll */
        .isabelle-img {
            position: fixed; 
            bottom: -5px; 
            left: -20px; 
            width: 150px;
            z-index: 20;
            filter: drop-shadow(5px 5px 0 rgba(0,0,0,0.1));
            pointer-events: none; /* Permet de cliquer √† travers si besoin */
        }

        /* --- PASSEPORT --- */
        .passport {
            background: var(--passport-bg);
            width: 90%; 
            max-width: 380px;
            border-radius: 25px;
            box-shadow: 0 15px 0 rgba(0,0,0,0.1);
            position: relative; z-index: 10;
            border: 5px solid white;
            transform: rotate(2deg);
            transition: transform 0.3s;
            margin-bottom: 20px; /* Espace sous le passeport */
        }
        .passport:hover { transform: rotate(0) scale(1.02); }

        .passport-header {
            background: #5bbd83; padding: 12px 20px;
            display: flex; justify-content: space-between; align-items: center; color: white;
            border-radius: 18px 18px 0 0;
        }
        .passport-title { font-family: 'Fredoka', sans-serif; font-size: 1.3em; letter-spacing: 1px; }
        
        .island-tag {
            background: rgba(0,0,0,0.15); padding: 4px 10px; border-radius: 15px;
            font-size: 0.8em; font-weight: bold;
        }

        .passport-body { padding: 20px; display: grid; grid-template-columns: 1fr 1.5fr; gap: 15px; position: relative; }

        /* Photo de N√®ve */
        .photo-area {
            background: #aedecf; border-radius: 15px; height: 120px;
            display: flex; align-items: center; justify-content: center;
            border: 4px solid white; box-shadow: 0 3px 0 rgba(0,0,0,0.1);
            position: relative; overflow: hidden;
        }
        .photo-area img { width: 100%; height: 100%; object-fit: cover; }
        
        .age-badge {
            position: absolute; bottom: 0; width: 100%; text-align: center;
            background: var(--ac-orange); color: white; padding: 3px 0;
            font-weight: bold; font-size: 0.9em; text-shadow: 1px 1px 0 rgba(0,0,0,0.1);
        }

        .info-row { margin-bottom: 10px; border-bottom: 2px dashed #e0e0e0; padding-bottom: 4px; }
        .label { color: #5bbd83; font-size: 0.7em; font-weight: bold; text-transform: uppercase; display: block; letter-spacing: 0.5px; }
        
        .value { font-size: 1.1em; font-weight: bold; color: var(--ac-text); display: inline-block;}
        
        .clickable {
            cursor: pointer;
            border-bottom: 2px dotted var(--ac-blue);
            transition: color 0.2s, border-color 0.2s;
            text-decoration: none;
            color: var(--ac-text);
        }
        .clickable:hover { color: var(--ac-blue); border-bottom-style: solid; }

        .stamp {
            position: absolute; bottom: 15px; right: 10px; width: 65px; height: 65px;
            opacity: 0.5; transform: rotate(-15deg); mix-blend-mode: multiply;
        }

        /* --- BOUTON ACTION --- */
        .cta-container { 
            z-index: 30; /* Au dessus de Marie */
            position: relative;
        }
        
        .nook-btn {
            background: linear-gradient(to bottom, #2aa5ef, #238ac7);
            color: white; border: none; padding: 14px 30px; border-radius: 50px;
            font-family: 'Fredoka', sans-serif; font-size: 1.2em;
            display: flex; align-items: center; gap: 12px;
            cursor: pointer; box-shadow: 0 6px 0 #1a6b9c, 0 10px 20px rgba(0,0,0,0.2);
            transition: all 0.1s; border: 2px solid white;
        }
        .nook-btn:active { transform: translateY(6px); box-shadow: none; }
        .nook-btn svg { width: 24px; height: 24px; fill: white; }

        /* --- NOOK PHONE --- */
        .phone-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); z-index: 100;
            display: flex; justify-content: center; align-items: flex-end;
            visibility: hidden; opacity: 0; transition: 0.3s;
            backdrop-filter: blur(3px);
        }
        .phone-overlay.active { visibility: visible; opacity: 1; }

        .nook-phone {
            width: 95%; max-width: 400px; height: 85vh;
            background: #f2f2f2; border-radius: 40px 40px 0 0;
            padding: 15px; display: flex; flex-direction: column;
            transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border: 8px solid #65dca6; border-bottom: none;
            box-shadow: 0 -10px 30px rgba(0,0,0,0.3);
        }
        .phone-overlay.active .nook-phone { transform: translateY(0); }

        .chat-header {
            background: #65dca6; padding: 12px; border-radius: 20px 20px 0 0;
            display: flex; align-items: center; gap: 12px; color: white; font-weight: bold;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .tom-nook-avatar {
            width: 45px; height: 45px; border-radius: 50%; 
            background: white; border: 2px solid white; overflow: hidden;
            display: flex; align-items: center; justify-content: center;
        }
        .tom-nook-avatar img { width: 100%; height: 100%; object-fit: cover; object-position: top center; }

        .chat-body {
            flex: 1; background: #e6f7ef; padding: 15px; overflow-y: auto;
            display: flex; flex-direction: column; gap: 12px;
            border-left: 2px solid #cbebd8; border-right: 2px solid #cbebd8;
            background-image: radial-gradient(#cbebd8 10%, transparent 10%);
            background-size: 20px 20px;
        }

        .msg { 
            padding: 12px 16px; border-radius: 18px; font-size: 0.95em; max-width: 85%; 
            animation: pop 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: 0 2px 0 rgba(0,0,0,0.05);
        }
        .msg-l { background: white; align-self: flex-start; border-bottom-left-radius: 2px; color: #555; }
        .msg-r { background: #65dca6; align-self: flex-end; border-bottom-right-radius: 2px; color: white; }
        @keyframes pop { from{transform:scale(0);} to{transform:scale(1);} }

        .chat-input { background: white; padding: 15px; border-top: 1px solid #ddd; }
        input { 
            width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 15px; margin-bottom: 10px; 
            font-family: inherit; font-size: 16px; outline: none;
        }
        input:focus { border-color: #65dca6; background: #f9fffc; }

        .btns { display: flex; gap: 10px; }
        .btn-opt { 
            flex: 1; padding: 12px; border: 2px solid #eee; background: white; 
            border-radius: 12px; color: #aaa; font-weight: bold; font-size: 0.9em; transition: 0.2s; 
        }
        .btn-opt.selected { border-color: #65dca6; background: #eafff3; color: #65dca6; transform: scale(1.02); }
        
        .btn-send { 
            width: 100%; background: #2aa5ef; color: white; border: none; padding: 15px; 
            border-radius: 30px; font-weight: bold; margin-top: 10px; font-size: 1.1em; 
            box-shadow: 0 4px 0 #1a6b9c;
        }
        .btn-send:active { transform: translateY(4px); box-shadow: none; }

        .typing { display:flex; gap:4px; padding: 15px 15px !important; width: 60px; }
        .dot { width: 8px; height: 8px; background: #ccc; border-radius: 50%; animation: blink 1.4s infinite both; }
        .dot:nth-child(1){animation-delay: -0.32s;} .dot:nth-child(2){animation-delay: -0.16s;}
        @keyframes blink { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } }

    </style>
</head>
<body>

    <img src="https://i.ibb.co/SwN9xBXZ/5b4a216ec051e602a568cd7e.png" class="game-logo" alt="Logo AC">

    <!-- BALLON -->
    <div class="balloon-container">
        <svg viewBox="0 0 100 120" width="80" style="overflow:visible">
            <path d="M50,5 C25,5 5,30 5,55 C5,85 40,110 50,115 C60,110 95,85 95,55 C95,30 75,5 50,5" fill="#ff5252"/>
            <path d="M25,20 Q35,15 45,30" fill="none" stroke="rgba(255,255,255,0.3)" stroke-width="5"/>
            <line x1="50" y1="115" x2="50" y2="150" stroke="#888" stroke-width="2" />
        </svg>
        <div class="gift-box">
            <div class="gift-ribbon"></div>
            <div class="gift-ribbon-v"></div>
        </div>
    </div>

    <!-- Marie est maintenant en position: fixed via CSS -->
    <img src="https://i.ibb.co/XxdVmFM8/5f539984060f2e000485808f.png" class="isabelle-img" alt="Marie">

    <!-- PASSEPORT -->
    <div class="passport">
        <div class="passport-header">
            <div class="passport-title">PASSEPORT</div>
            <div class="island-tag">üå¥ N√®ve's Island</div>
        </div>
        <div class="passport-body">
            <div class="photo-area">
                <img src="https://i.ibb.co/B5yZr3zZ/IMG-7396.jpg" alt="N√®ve">
                <div class="age-badge">7 ANS</div>
            </div>
            <div class="info-area">
                <div class="info-row">
                    <span class="label">√âv√©nement</span>
                    <span class="value">Mon Anniversaire !</span>
                </div>
                <div class="info-row">
                    <span class="label">Date</span>
                    <span class="value clickable" onclick="addToCalendar()">
                        Mercredi 26 Nov. üìÖ
                    </span>
                </div>
                <div class="info-row">
                    <span class="label">Lieu</span>
                    <a href="https://www.google.com/maps/search/?api=1&query=Girafou+B√©nouville" target="_blank" class="value clickable">
                        Girafou (B√©nouville) üìç
                    </a>
                </div>
                 <div class="info-row">
                    <span class="label">Heure</span>
                    <span class="value">14h00 - 18h00</span>
                </div>
            </div>
            
            <svg class="stamp" viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="45" fill="none" stroke="#2aa5ef" stroke-width="4"/>
                <path d="M20 50 L40 70 L80 30" fill="none" stroke="#2aa5ef" stroke-width="6" stroke-linecap="round" stroke-linejoin="round"/>
                <text x="50" y="90" font-size="14" text-anchor="middle" fill="#2aa5ef" font-weight="bold" font-family="sans-serif">DAL</text>
            </svg>
        </div>
    </div>

    <!-- BOUTON ACTION -->
    <div class="cta-container">
        <button class="nook-btn" onclick="openPhone()">
            <svg viewBox="0 0 24 24"><path d="M17,2H7C5.9,2,5,2.9,5,4v16c0,1.1,0.9,2,2,2h10c1.1,0,2-0.9,2-2V4C19,2.9,18.1,2,17,2z M12,19 c-0.6,0-1-0.4-1-1s0.4-1,1-1s1,0.4,1,1S12.6,19,12,19z"/></svg>
            R√©pondre (RSVP)
        </button>
    </div>

    <!-- PHONE OVERLAY -->
    <div class="phone-overlay" id="phoneOverlay">
        <div class="nook-phone">
            <div style="text-align:right;">
                <button onclick="closePhone()" style="background:#ff6b6b; color:white; border:none; width:32px; height:32px; border-radius:50%; font-weight:bold; cursor:pointer;">‚úï</button>
            </div>
            <div class="chat-header">
                <div class="tom-nook-avatar">
                    <img src="https://i.ibb.co/Q3Ff7Ysk/toppng-com-animal-crossing-nook-400x600.png" alt="Nook">
                </div>
                <span>Tom Nook</span>
            </div>
            
            <div class="chat-body" id="chatBox"></div>

            <div class="chat-input">
                <input type="text" id="nameInput" placeholder="Ton Pr√©nom (ex: Ethan)...">
                <div class="btns">
                    <button class="btn-opt selected" onclick="setOpt('oui', this)">Je viens! üéÅ</button>
                    <button class="btn-opt" onclick="setOpt('non', this)">Je ne peux pas üíß</button>
                </div>
                <button class="btn-send" onclick="send()">Envoyer SMS</button>
            </div>
        </div>
    </div>

    <script>
        let chatInit = false;
        let choice = 'oui';

        function addToCalendar() {
            const eventStart = "20251126T140000";
            const eventEnd = "20251126T180000";
            const title = "Anniversaire N√®ve 7 ans";
            const location = "Girafou, B√©nouville";
            const description = "Viens f√™ter mes 7 ans ! üéÇ";

            const icsContent = 
`BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
SUMMARY:${title}
DTSTART:${eventStart}
DTEND:${eventEnd}
LOCATION:${location}
DESCRIPTION:${description}
END:VEVENT
END:VCALENDAR`;

            const blob = new Blob([icsContent], { type: 'text/calendar' });
            const url = window.URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.setAttribute('download', 'Anniversaire_Neve.ics');
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function openPhone(){
            document.getElementById('phoneOverlay').classList.add('active');
            if(!chatInit){
                chatInit = true;
                addTyping();
                setTimeout(()=>{ removeTyping(); msg("Bonjour ! C'est Tom Nook üçÉ", 'l'); }, 800);
                setTimeout(()=>{ addTyping(); }, 1200);
                setTimeout(()=>{ removeTyping(); msg("N√®ve f√™te ses 7 ans le 26 Novembre √† Girafou !", 'l'); }, 2200);
                setTimeout(()=>{ addTyping(); }, 2600);
                setTimeout(()=>{ removeTyping(); msg("Est-ce qu'on peut compter sur ta pr√©sence ?", 'l'); }, 3500);
            }
        }

        function closePhone(){ document.getElementById('phoneOverlay').classList.remove('active'); }
        
        function msg(txt, side){
            const div = document.createElement('div');
            div.className = `msg msg-${side}`;
            div.innerText = txt;
            document.getElementById('chatBox').appendChild(div);
            document.getElementById('chatBox').scrollTop = 9999;
        }

        function addTyping(){
            const div = document.createElement('div');
            div.id = "typing";
            div.className = `msg msg-l typing`;
            div.innerHTML = '<div class="dot"></div><div class="dot"></div><div class="dot"></div>';
            document.getElementById('chatBox').appendChild(div);
            document.getElementById('chatBox').scrollTop = 9999;
        }

        function removeTyping(){
            const el = document.getElementById('typing');
            if(el) el.remove();
        }

        function setOpt(c, el){
            choice = c;
            document.querySelectorAll('.btn-opt').forEach(b=>b.classList.remove('selected'));
            el.classList.add('selected');
        }

        function send(){
            const name = document.getElementById('nameInput').value;
            if(!name) {
                alert("Tom Nook a besoin de ton pr√©nom !");
                return;
            }
            
            msg(choice==='oui'?"Je viens ! üéâ":"Je ne peux pas üò¢", 'r');
            
            let txt = choice==='oui' 
                ? `Coucou N√®ve ! C'est ${name}. Je viens avec grand plaisir √† ton anniversaire le 26 √† Girafou ! Trop h√¢te ! üéÅ` 
                : `Coucou N√®ve ! C'est ${name}. D√©sol√©, je ne pourrai pas venir. Passez un super anniversaire ! üçÉ`;
            
            setTimeout(()=>{
                const ua = navigator.userAgent.toLowerCase();
                let sep = (ua.includes('iphone')||ua.includes('ipad')) ? '&' : '?';
                window.location.href = `sms:0614913692${sep}body=${encodeURIComponent(txt)}`;
            }, 1000);
        }

        document.getElementById('phoneOverlay').addEventListener('click', function(e){
            if(e.target === this) closePhone();
        });
    </script>
</body>
</html>